<div class="max-w-6xl mx-auto px-4 py-8">
  <%= search_form_for @q, url: events_path, method: :get, class: "mb-6" do |f| %>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
      <div>
        <%= f.label :title_cont, "„Ç§„Éô„É≥„ÉàÂêç", class: "text-xs text-slate-600" %>
        <%= f.search_field :title_cont, class: "w-full rounded-md border px-3 py-2 text-sm" %>
      </div>

      <div>
        <%= f.label :shop_name_cont, "Â∫óËàóÂêç", class: "text-xs text-slate-600" %>
        <%= f.search_field :shop_name_cont, class: "w-full rounded-md border px-3 py-2 text-sm" %>
      </div>

      <div>
        <%= f.label :shop_prefecture_eq, "ÈÉΩÈÅìÂ∫úÁúå", class: "text-xs text-slate-600" %>
        <%= f.search_field :shop_prefecture_eq, placeholder: "‰æãÔºöÂÆÆÂ¥éÁúå", class: "w-full rounded-md border px-3 py-2 text-sm" %>
      </div>

      <div>
        <%= f.label :start_datetime_gteq, "ÈñãÂÇ¨Êó•ÔºàÈñãÂßãÔºâ", class: "text-xs text-slate-600" %>
        <%= f.date_field :start_datetime_gteq, class: "w-full rounded-md border px-3 py-2 text-sm" %>
      </div>

      <div>
        <%= f.label :start_datetime_lteq, "ÈñãÂÇ¨Êó•ÔºàÁµÇ‰∫ÜÔºâ", class: "text-xs text-slate-600" %>
        <%= f.date_field :start_datetime_lteq, class: "w-full rounded-md border px-3 py-2 text-sm" %>
      </div>

      <div>
        <%= f.label :participants_id_eq, "ÂèÇÂä†„Éó„É≠", class: "text-xs text-slate-600" %>
        <%= f.select :participants_id_eq,
              options_from_collection_for_select(@pros, :id, :name, @q.participants_id_eq),
              { include_blank: "ÈÅ∏Êäû„Å™„Åó" },
              class: "w-full rounded-md border px-3 py-2 text-sm" %>
      </div>
    </div>

    <div class="mt-4 flex gap-2">
      <%= f.submit "Ê§úÁ¥¢", class: "rounded-md bg-black px-4 py-2 text-sm font-semibold text-white" %>
      <%= link_to "„ÇØ„É™„Ç¢", events_path, class: "rounded-md border px-4 py-2 text-sm font-semibold" %>
    </div>
  <% end %>
  <h1 class="text-2xl font-bold mb-6">„Ç§„Éô„É≥„Éà‰∏ÄË¶ß</h1>

  <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
    <% @events.each do |event| %>
      <%= link_to event_path(event), class: "block group rounded-3xl bg-white border border-slate-100 shadow-sm overflow-hidden hover:shadow-md transition-shadow" do %>
        <div class="relative h-44 w-full overflow-hidden">
          <% if event.images.attached? %>
            <% main_image = event.images.first %>
            <%= image_tag main_image.variant(resize_to_fill: [800, 400]),
                  class: "h-full w-full object-cover transition-transform duration-200 group-hover:scale-105" %>
          <% else %>
            <div class="h-full w-full bg-gradient-to-br from-slate-100 to-slate-200 flex items-center justify-center text-slate-400 text-sm">
              No Image
            </div>
          <% end %>
        </div>

        <div class="px-4 pb-4 pt-3">
          <span class="inline-flex items-center rounded-full bg-rose-50 px-3 py-1 text-xs font-semibold text-rose-500">
            „Éà„Éº„Éä„É°„É≥„Éà
          </span>

          <h2 class="mt-2 text-[15px] font-semibold text-slate-900 leading-snug line-clamp-2 group-hover:underline">
            <%= event.title %>
          </h2>

          <div class="space-y-1.5 text-xs text-slate-600 my-3">
            <p class="flex items-center gap-1.5">
              üìÖ <%= event.start_datetime ? l(event.start_datetime, format: :short) : "Êó•ÊôÇÊú™ÂÆö" %>
            </p>
            <p class="flex items-center gap-1.5">
              üìç <%= event.location.presence || event.shop&.name || "‰ºöÂ†¥Êú™ÂÆö" %>
            </p>
          </div>

          <% if event.description.present? %>
            <p class="text-xs text-slate-500 mb-3 line-clamp-2">
              <%= event.description %>
            </p>
          <% end %>

          <div class="flex items-center justify-between text-[11px] text-slate-500">
            <span>üë• <%= event.capacity || "Êú™Ë®≠ÂÆö" %>‰∫∫</span>
            <span>üè† <%= event.shop&.name || "Â∫óËàóÊú™ÁôªÈå≤" %></span>
          </div>

        </div>
      <% end %>
    <% end %>
  </div>
  <div class="mt-6 flex justify-center">
    <%= paginate @events %>
  </div>
</div>