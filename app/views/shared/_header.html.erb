<header class="sticky top-0 z-40 w-full bg-white border-b" data-controller="menu">
  <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
    <%= link_to root_path, class: "flex items-center gap-2" do %>
      <span class="text-m font-semibold tracking-wide">Darts Events</span>
    <% end %>

    <div class="flex-1 max-w-xs sm:max-w-sm md:max-w-xl">
      <form action="<%= events_path %>" method="get" class="w-full">
        <div class="flex items-center bg-slate-100 rounded-full px-3 py-1.5 gap-2">
          <input
            type="text"
            name="q[title_or_description_or_shop_name_or_shop_prefecture_cont]"
            value="<%= params.dig(:q, :title_or_description_or_shop_name_or_shop_prefecture_cont) %>"
            placeholder="„Ç§„Éô„É≥„ÉàÂêç„ÉªË©≥Á¥∞„ÉªÂ∫óËàóÂêç„ÉªÈÉΩÈÅìÂ∫úÁúå„ÅßÊ§úÁ¥¢"
            class="flex-1 bg-transparent text-sm outline-none placeholder:text-slate-400"
          >
          <button type="submit" class="text-slate-500">üîç</button>
        </div>
      </form>
    </div>

    <nav class="hidden md:flex items-center gap-2 text-xs ml-auto">

      <%= link_to "„Ç§„Éô„É≥„Éà‰∏ÄË¶ß/Ê§úÁ¥¢",
            events_path,
            class: "inline-flex items-center rounded-full border border-slate-300 px-4 py-1.5 font-semibold text-slate-700 hover:bg-slate-50" %>

      <%= link_to "Â∫óËàó‰∏ÄË¶ß",
            shops_path,
            class: "inline-flex items-center rounded-full border border-slate-300 px-4 py-1.5 font-semibold text-slate-700 hover:bg-slate-50" %>

      <%= link_to "Â∫óËàóÁôªÈå≤",
            new_shop_path,
            class: "inline-flex items-center rounded-full border border-slate-300 px-4 py-1.5 font-semibold text-slate-700 hover:bg-slate-50" %>

      <%= link_to notifications_path,
            class: "relative inline-flex items-center rounded-full border border-slate-300 px-4 py-1.5 font-semibold text-slate-700 hover:bg-slate-50 text-xs" do %>

        <span>ÈÄöÁü•</span>

        <% if @unread_notifications_count.to_i > 0 %>
          <span class="absolute -top-2 -right-2 min-w-[18px] h-[18px]
                      rounded-full bg-red-500 text-white text-[10px]
                      flex items-center justify-center font-bold">
            <%= @unread_notifications_count > 99 ? "99+" : @unread_notifications_count %>
          </span>
        <% end %>

      <% end %>
      <% if user_signed_in? %>
        <%= link_to "„Éû„Ç§„Éö„Éº„Ç∏",
              mypage_path,
              class: "inline-flex items-center rounded-full border border-slate-300 px-4 py-1.5 font-semibold text-slate-700 hover:bg-slate-50 text-xs" %>

        <%= button_to "„É≠„Ç∞„Ç¢„Ç¶„Éà",
              destroy_user_session_path,
              method: :delete,
              form: { data: { turbo_confirm: "„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü" } },
              class: "px-3 py-1.5 rounded-full bg-black text-white hover:bg-slate-800 text-xs" %>
      <% else %>
        <%= link_to "Êñ∞Ë¶èÁôªÈå≤",
              new_user_registration_path,
              class: "inline-flex items-center rounded-full border border-slate-300 px-4 py-1.5 font-semibold text-slate-700 hover:bg-slate-50" %>
        <%= link_to "„É≠„Ç∞„Ç§„É≥",
              new_user_session_path,
              class: "px-3 py-1.5 rounded-full bg-black text-white hover:bg-slate-800" %>
      <% end %>
    </nav>
    <button
      type="button"
      class="inline-flex items-center justify-center h-9 w-9 rounded-md border border-slate-300 text-slate-700 md:hidden"
      data-action="click->menu#toggle"
    >
      <span data-menu-target="iconOpen" class="text-lg leading-none">‚ò∞</span>
      <span data-menu-target="iconClose" class="text-lg leading-none hidden">‚úï</span>
    </button>
  </div>

  <div
    data-menu-target="backdrop"
    data-action="click->menu#close"
    class="hidden fixed inset-0 bg-black/30 md:hidden z-30"
  ></div>

  <div
    data-menu-target="panel"
    class="fixed inset-y-0 right-0 z-40 w-64 max-w-[75%] bg-white shadow-lg
          transform translate-x-full transition-transform duration-400 md:hidden"
  >
    <nav class="h-full px-4 py-4 flex flex-col gap-2 text-sm">
      <%= link_to "„Ç§„Éô„É≥„Éà‰∏ÄË¶ß/Ê§úÁ¥¢", events_path,
            class: "py-2 border-b border-slate-100 text-slate-700 hover:bg-slate-50" %>
      <%= link_to "Â∫óËàó‰∏ÄË¶ß", shops_path,
            class: "py-2 border-b border-slate-100 text-slate-700 hover:bg-slate-50" %>
      <%= link_to "Â∫óËàóÁôªÈå≤", new_shop_path,
            class: "py-2 border-b border-slate-100 text-slate-700 hover:bg-slate-50" %>
      <%= link_to "ÈÄöÁü•", notifications_path,
            class: "py-2 border-b border-slate-100 text-slate-700 hover:bg-slate-50" %>
      <% if user_signed_in? %>
        <%= link_to "„Éû„Ç§„Éö„Éº„Ç∏", root_path,
            class: "py-2 border-b border-slate-100 text-slate-700 hover:bg-slate-50" %>
        <%= button_to "„É≠„Ç∞„Ç¢„Ç¶„Éà",
              destroy_user_session_path,
              method: :delete,
              form: { data: { turbo_confirm: "„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü" } },
              class: "py-2 border-b border-slate-100 text-slate-700 hover:bg-slate-50" %>
      <% else %>
        <%= link_to "Êñ∞Ë¶èÁôªÈå≤", new_user_registration_path,
              class: "block py-2 text-slate-700 hover:bg-slate-50" %>
        <%= link_to "„É≠„Ç∞„Ç§„É≥", new_user_session_path,
              class: "block py-2 text-white bg-black rounded-md text-center mt-1 hover:bg-slate-800" %>
      <% end %>
    </nav>
  </div>
</header>